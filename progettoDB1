--
-- PostgreSQL database dump
--

-- Dumped from database version 9.6.17
-- Dumped by pg_dump version 12.2

-- Started on 2020-08-15 23:13:24

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

DROP DATABASE dbalessiomungelli;
--
-- TOC entry 3097 (class 1262 OID 2826653)
-- Name: dbalessiomungelli; Type: DATABASE; Schema: -; Owner: -
--

CREATE DATABASE dbalessiomungelli WITH TEMPLATE = template0 ENCODING = 'UTF8' LC_COLLATE = 'en_US.UTF-8' LC_CTYPE = 'en_US.UTF-8';


\connect dbalessiomungelli

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 10 (class 2615 OID 3285558)
-- Name: dbprogettoMUNGELLI; Type: SCHEMA; Schema: -; Owner: -
--

CREATE SCHEMA "dbprogettoMUNGELLI";


SET default_tablespace = '';

--
-- TOC entry 206 (class 1259 OID 3285738)
-- Name: cinema; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".cinema (
    idcinema integer NOT NULL,
    nome character varying(40) NOT NULL,
    citta character varying(30) NOT NULL,
    via character varying(30) NOT NULL,
    numerocivico smallint NOT NULL,
    cap smallint NOT NULL,
    telefono character varying(20) NOT NULL,
    fax character varying(20),
    email character varying(40)
);


--
-- TOC entry 205 (class 1259 OID 3285736)
-- Name: cinema_idcinema_seq; Type: SEQUENCE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE SEQUENCE "dbprogettoMUNGELLI".cinema_idcinema_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- TOC entry 3098 (class 0 OID 0)
-- Dependencies: 205
-- Name: cinema_idcinema_seq; Type: SEQUENCE OWNED BY; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER SEQUENCE "dbprogettoMUNGELLI".cinema_idcinema_seq OWNED BY "dbprogettoMUNGELLI".cinema.idcinema;


--
-- TOC entry 201 (class 1259 OID 3285659)
-- Name: film; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".film (
    idfilm integer NOT NULL,
    titolo character varying(50) NOT NULL,
    paeseuscita character varying(20) NOT NULL,
    datauscita date NOT NULL,
    numerovoti integer DEFAULT 0 NOT NULL,
    genere character varying(20) NOT NULL,
    mediavoti real DEFAULT 0 NOT NULL,
    descrizione character varying(200) NOT NULL,
    fotografia character varying(100),
    musiche character varying(100),
    ideatore character varying(50),
    produzione character varying(30) NOT NULL,
    distribuzione character varying(30) NOT NULL,
    durata time without time zone NOT NULL,
    nomeregista character varying(20) NOT NULL,
    cognomeregista character varying(30) NOT NULL,
    datanascitaregista date NOT NULL
);


--
-- TOC entry 200 (class 1259 OID 3285657)
-- Name: film_idfilm_seq; Type: SEQUENCE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE SEQUENCE "dbprogettoMUNGELLI".film_idfilm_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


--
-- TOC entry 3099 (class 0 OID 0)
-- Dependencies: 200
-- Name: film_idfilm_seq; Type: SEQUENCE OWNED BY; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER SEQUENCE "dbprogettoMUNGELLI".film_idfilm_seq OWNED BY "dbprogettoMUNGELLI".film.idfilm;


--
-- TOC entry 197 (class 1259 OID 3285572)
-- Name: genere; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".genere (
    genere character varying(20) NOT NULL
);


--
-- TOC entry 198 (class 1259 OID 3285580)
-- Name: paeseuscita; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".paeseuscita (
    paeseuscita character varying(20) NOT NULL
);


--
-- TOC entry 199 (class 1259 OID 3285617)
-- Name: partecipante; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".partecipante (
    nome character varying(20) NOT NULL,
    cognome character varying(30) NOT NULL,
    datanascita date NOT NULL,
    sceneggiatore boolean DEFAULT false,
    attore boolean DEFAULT false,
    regista boolean DEFAULT false,
    foto bytea
);


--
-- TOC entry 204 (class 1259 OID 3285721)
-- Name: preferenzafilm; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".preferenzafilm (
    utente character varying(15) NOT NULL,
    idfilm integer NOT NULL
);


--
-- TOC entry 202 (class 1259 OID 3285685)
-- Name: utente; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".utente (
    nomeutente character varying(15) NOT NULL,
    password character varying(30) NOT NULL,
    email character varying(30) NOT NULL,
    datainiziocollaborazione date
);


--
-- TOC entry 203 (class 1259 OID 3285705)
-- Name: votofilm; Type: TABLE; Schema: dbprogettoMUNGELLI; Owner: -
--

CREATE TABLE "dbprogettoMUNGELLI".votofilm (
    utente character varying(15) NOT NULL,
    idfilm integer NOT NULL,
    voto integer NOT NULL,
    CONSTRAINT votofilm_voto_check CHECK (((voto >= 1) AND (voto <= 5)))
);


--
-- TOC entry 2941 (class 2604 OID 3285741)
-- Name: cinema idcinema; Type: DEFAULT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".cinema ALTER COLUMN idcinema SET DEFAULT nextval('"dbprogettoMUNGELLI".cinema_idcinema_seq'::regclass);


--
-- TOC entry 2937 (class 2604 OID 3285662)
-- Name: film idfilm; Type: DEFAULT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".film ALTER COLUMN idfilm SET DEFAULT nextval('"dbprogettoMUNGELLI".film_idfilm_seq'::regclass);


--
-- TOC entry 3091 (class 0 OID 3285738)
-- Dependencies: 206
-- Data for Name: cinema; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--



--
-- TOC entry 3086 (class 0 OID 3285659)
-- Dependencies: 201
-- Data for Name: film; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--



--
-- TOC entry 3082 (class 0 OID 3285572)
-- Dependencies: 197
-- Data for Name: genere; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--

INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Azione');
INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Comico');
INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Commedia');
INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Dramma');
INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Horror');
INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Fantascienza');
INSERT INTO "dbprogettoMUNGELLI".genere VALUES ('Animazione');


--
-- TOC entry 3083 (class 0 OID 3285580)
-- Dependencies: 198
-- Data for Name: paeseuscita; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--

INSERT INTO "dbprogettoMUNGELLI".paeseuscita VALUES ('Italia
');
INSERT INTO "dbprogettoMUNGELLI".paeseuscita VALUES ('Francia');
INSERT INTO "dbprogettoMUNGELLI".paeseuscita VALUES ('Spagna');
INSERT INTO "dbprogettoMUNGELLI".paeseuscita VALUES ('USA');
INSERT INTO "dbprogettoMUNGELLI".paeseuscita VALUES ('Angola');
INSERT INTO "dbprogettoMUNGELLI".paeseuscita VALUES ('Nigeria');


--
-- TOC entry 3084 (class 0 OID 3285617)
-- Dependencies: 199
-- Data for Name: partecipante; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--

INSERT INTO "dbprogettoMUNGELLI".partecipante VALUES ('Sergio', 'Leone', '1929-01-03', false, false, true, NULL);
INSERT INTO "dbprogettoMUNGELLI".partecipante VALUES ('Stephen', 'Norrington', '1964-01-01', false, false, true, NULL);
INSERT INTO "dbprogettoMUNGELLI".partecipante VALUES ('Daisy', 'Ridley', '1992-04-10', false, true, false, NULL);
INSERT INTO "dbprogettoMUNGELLI".partecipante VALUES ('Harrison', 'Ford', '1942-07-13', true, true, true, NULL);
INSERT INTO "dbprogettoMUNGELLI".partecipante VALUES ('Roberto', 'Benigni', '1952-10-27', true, true, true, NULL);
INSERT INTO "dbprogettoMUNGELLI".partecipante VALUES ('Pier Paolo', 'Pasolini', '1922-03-05', true, false, false, NULL);


--
-- TOC entry 3089 (class 0 OID 3285721)
-- Dependencies: 204
-- Data for Name: preferenzafilm; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--



--
-- TOC entry 3087 (class 0 OID 3285685)
-- Dependencies: 202
-- Data for Name: utente; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--



--
-- TOC entry 3088 (class 0 OID 3285705)
-- Dependencies: 203
-- Data for Name: votofilm; Type: TABLE DATA; Schema: dbprogettoMUNGELLI; Owner: -
--



--
-- TOC entry 3100 (class 0 OID 0)
-- Dependencies: 205
-- Name: cinema_idcinema_seq; Type: SEQUENCE SET; Schema: dbprogettoMUNGELLI; Owner: -
--

SELECT pg_catalog.setval('"dbprogettoMUNGELLI".cinema_idcinema_seq', 1, false);


--
-- TOC entry 3101 (class 0 OID 0)
-- Dependencies: 200
-- Name: film_idfilm_seq; Type: SEQUENCE SET; Schema: dbprogettoMUNGELLI; Owner: -
--

SELECT pg_catalog.setval('"dbprogettoMUNGELLI".film_idfilm_seq', 1, false);


--
-- TOC entry 2957 (class 2606 OID 3285743)
-- Name: cinema cinema_pkey; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".cinema
    ADD CONSTRAINT cinema_pkey PRIMARY KEY (idcinema);


--
-- TOC entry 2949 (class 2606 OID 3285669)
-- Name: film film_pkey; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".film
    ADD CONSTRAINT film_pkey PRIMARY KEY (idfilm);


--
-- TOC entry 2943 (class 2606 OID 3285576)
-- Name: genere genere_pkey; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".genere
    ADD CONSTRAINT genere_pkey PRIMARY KEY (genere);


--
-- TOC entry 2945 (class 2606 OID 3285584)
-- Name: paeseuscita paeseuscita_pkey; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".paeseuscita
    ADD CONSTRAINT paeseuscita_pkey PRIMARY KEY (paeseuscita);


--
-- TOC entry 2947 (class 2606 OID 3285627)
-- Name: partecipante pk_partecipante; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".partecipante
    ADD CONSTRAINT pk_partecipante PRIMARY KEY (nome, cognome, datanascita);


--
-- TOC entry 2955 (class 2606 OID 3285725)
-- Name: preferenzafilm pk_preferenza; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".preferenzafilm
    ADD CONSTRAINT pk_preferenza PRIMARY KEY (utente, idfilm);


--
-- TOC entry 2953 (class 2606 OID 3285710)
-- Name: votofilm pk_voto; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".votofilm
    ADD CONSTRAINT pk_voto PRIMARY KEY (utente, idfilm);


--
-- TOC entry 2951 (class 2606 OID 3285689)
-- Name: utente utente_pkey; Type: CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".utente
    ADD CONSTRAINT utente_pkey PRIMARY KEY (nomeutente);


--
-- TOC entry 2962 (class 2606 OID 3285716)
-- Name: votofilm fk_filmvotato; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".votofilm
    ADD CONSTRAINT fk_filmvotato FOREIGN KEY (idfilm) REFERENCES "dbprogettoMUNGELLI".film(idfilm) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2964 (class 2606 OID 3285731)
-- Name: preferenzafilm fk_filmvotato; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".preferenzafilm
    ADD CONSTRAINT fk_filmvotato FOREIGN KEY (idfilm) REFERENCES "dbprogettoMUNGELLI".film(idfilm) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2959 (class 2606 OID 3285675)
-- Name: film fk_genere; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".film
    ADD CONSTRAINT fk_genere FOREIGN KEY (genere) REFERENCES "dbprogettoMUNGELLI".genere(genere) ON UPDATE CASCADE ON DELETE SET NULL;


--
-- TOC entry 2958 (class 2606 OID 3285670)
-- Name: film fk_paeseuscita; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".film
    ADD CONSTRAINT fk_paeseuscita FOREIGN KEY (paeseuscita) REFERENCES "dbprogettoMUNGELLI".paeseuscita(paeseuscita) ON UPDATE CASCADE ON DELETE SET NULL;


--
-- TOC entry 2960 (class 2606 OID 3285680)
-- Name: film fk_regista; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".film
    ADD CONSTRAINT fk_regista FOREIGN KEY (nomeregista, cognomeregista, datanascitaregista) REFERENCES "dbprogettoMUNGELLI".partecipante(nome, cognome, datanascita);


--
-- TOC entry 2961 (class 2606 OID 3285711)
-- Name: votofilm fk_votonomeutente; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".votofilm
    ADD CONSTRAINT fk_votonomeutente FOREIGN KEY (utente) REFERENCES "dbprogettoMUNGELLI".utente(nomeutente) ON UPDATE CASCADE ON DELETE CASCADE;


--
-- TOC entry 2963 (class 2606 OID 3285726)
-- Name: preferenzafilm fk_votonomeutente; Type: FK CONSTRAINT; Schema: dbprogettoMUNGELLI; Owner: -
--

ALTER TABLE ONLY "dbprogettoMUNGELLI".preferenzafilm
    ADD CONSTRAINT fk_votonomeutente FOREIGN KEY (utente) REFERENCES "dbprogettoMUNGELLI".utente(nomeutente) ON UPDATE CASCADE ON DELETE CASCADE;


-- Completed on 2020-08-15 23:13:28

--
-- PostgreSQL database dump complete
--

